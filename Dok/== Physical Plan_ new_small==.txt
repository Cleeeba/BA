== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Sort [NgramId#16L ASC NULLS FIRST, Year#48 ASC NULLS FIRST], true, 0
   +- Project [NgramId#16L, Year#48, Frequency_N#75L, Frequency_L#88L, value#71L AS Frequency_R#103L]
      +- BroadcastHashJoin [NgramId#16L, Year#48], [NgramId#93L, Year#70], Inner, BuildRight, false
         :- Project [NgramId#16L, Year#48, Frequency_N#75L, value#60L AS Frequency_L#88L]
         :  +- BroadcastHashJoin [NgramId#16L, Year#48], [NgramId#79L, Year#59], Inner, BuildRight, false
         :     :- Project [NgramId#16L, Year#48, value#49L AS Frequency_N#75L]
         :     :  +- Filter ((Year#48 >= 1800) AND (Year#48 < 2000))
         :     :     +- Generate explode(new_Frequency_N#42), [NgramId#16L], false, [Year#48, value#49L]
         :     :        +- Filter (((size(new_Frequency_N#42, true) > 0) AND isnotnull(new_Frequency_N#42)) AND isnotnull(NgramId#16L))
         :     :           +- GlobalLimit 10, 0
         :     :              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=118]
         :     :                 +- LocalLimit 10
         :     :                    +- Project [NgramId#16L, map_concat(map(keys: [1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1840,1841,1842,1843,1844,1845,1846,1847,1848,1849,1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000], values: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), Frequency_N#17) AS new_Frequency_N#42]
         :     :                       +- FileScan parquet [NgramId#16L,Frequency_N#17] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/simhomes/binzc/data_transfer/freq_small], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<NgramId:bigint,Frequency_N:map<int,bigint>>
         :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true], input[1, int, false]),false), [plan_id=130]
         :        +- Filter ((Year#59 >= 1800) AND (Year#59 < 2000))
         :           +- Generate explode(new_Frequency_L#53), [NgramId#79L], false, [Year#59, value#60L]
         :              +- Filter (((size(new_Frequency_L#53, true) > 0) AND isnotnull(new_Frequency_L#53)) AND isnotnull(NgramId#79L))
         :                 +- GlobalLimit 10, 0
         :                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=124]
         :                       +- LocalLimit 10
         :                          +- Project [NgramId#79L, map_concat(map(keys: [1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1840,1841,1842,1843,1844,1845,1846,1847,1848,1849,1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000], values: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), Frequency_L#81) AS new_Frequency_L#53]
         :                             +- FileScan parquet [NgramId#79L,Frequency_L#81] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/simhomes/binzc/data_transfer/freq_small], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<NgramId:bigint,Frequency_L:map<int,bigint>>
         +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true], input[1, int, false]),false), [plan_id=139]
            +- Filter ((Year#70 >= 1800) AND (Year#70 < 2000))
               +- Generate explode(new_Frequency_R#64), [NgramId#93L], false, [Year#70, value#71L]
                  +- Filter (((size(new_Frequency_R#64, true) > 0) AND isnotnull(new_Frequency_R#64)) AND isnotnull(NgramId#93L))
                     +- GlobalLimit 10, 0
                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=133]
                           +- LocalLimit 10
                              +- Project [NgramId#93L, map_concat(map(keys: [1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1840,1841,1842,1843,1844,1845,1846,1847,1848,1849,1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000], values: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), Frequency_R#96) AS new_Frequency_R#64]
                                 +- FileScan parquet [NgramId#93L,Frequency_R#96] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/simhomes/binzc/data_transfer/freq_small], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<NgramId:bigint,Frequency_R:map<int,bigint>>